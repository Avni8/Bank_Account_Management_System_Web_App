<?xml version="1.0" encoding="UTF-8"?>
<!--
Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
Click nbfs://nbhost/SystemFileSystem/Templates/JSP_Servlet/XHtml.xhtml to edit this template
-->
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core"> 
    <h:head>
        <title>Account-Details</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

    </h:head>
    <body>
        <h:form class="my-navbar">    
            <ui:include src="topmenu.xhtml" />  
        </h:form>

        <p:dialog header="Create a new account" widgetVar="accountDialog" modal="true"
                  resizable="true" width="420">
            <h:form id="accountForm" styleClass="no-border-input">
                <h:panelGrid columns="2"> 

                    <p:outputLabel id="userLbl" for="userInp" value="User:"/>
                    <p:selectOneMenu id="userInp" value="#{accountController.account.user}" 
                                     converter="userConverter" required="true" 
                                     requiredMessage="User is required!">
                        <f:selectItem itemLabel="Select User" itemValue="" />
                        <f:selectItems value="#{accountController.userList}" 
                                       var="user" itemValue="#{user}" itemLabel="#{user.name}" />
                    </p:selectOneMenu>

                    <p:outputLabel id="productLbl" for="productInp" value="Product:"/>
                    <p:selectOneMenu id="productInp" value="#{accountController.account.product}" 
                                     converter="productConverter" required="true"
                                     requiredMessage="Product is required!">
                        <f:selectItem itemLabel="Select Product Type" itemValue="" />
                        <f:selectItems value="#{accountController.productList}" var="product" itemValue="#{product}" itemLabel="#{product.product_type}" />
                    </p:selectOneMenu>

                    <p:outputLabel id="accLbl" for="accInp" value="Account Number:"/>
                    <p:inputText id="accInp" value="#{accountController.account.accNo}" 
                                 required="true" requiredMessage="Account Number is required!"/>

                    <p:outputLabel id="interestLbl" for="interestInp" value="Interest Rate:"/>
                    <p:inputText id="interestInp" value="#{accountController.account.interestRate}" 
                                 required="true" requiredMessage="Interest Rate is required!"/>

                    <p:outputLabel id="openedDateLbl" for="openedDateInp" value="Opened Date:" />
                    <p:inputText id="openedDateInp" value="#{accountController.account.openedDate}"
                                 required="true" requiredMessage="Opened Date is required!"/>

                    <p:outputLabel id="matureDateLbl" for="matureDateInp" value="Mature Date:" />
                    <p:inputText id="matureDateInp" value="#{accountController.account.matureDate}" />

                    <p:outputLabel id="balanceLbl" for="balanceInp" value="Balance:" />
                    <p:inputText id="balanceInp" value="#{accountController.account.balance}" 
                                 required="true" requiredMessage="Initial Balance is required!"/>

                </h:panelGrid>
                <p:commandButton value="Save Account" action="#{accountController.createUpdate()}"
                                 style="margin-top: 10px;" 
                                 oncomplete="if (args &amp;&amp; !args.validationFailed) 
                                      PF('accountDialog').hide();"
                                 update=":listForm"/>
            </h:form>
        </p:dialog>
        <center>
            <h:form id="listForm" >
                <p:dataTable value="#{accountController.accountList}" var="account" paginator="true" 
                             rows="10"
                             paginatorPosition="bottom">

                    <f:facet name="header">
                        Account Details
                        <div class="button-container" style="position: absolute;
                             top: 45px;
                             left: 95.3%;
                             right: 0;
                             margin: 10px;">
                            <p:commandButton
                                oncomplete="PF('accountDialog').show()"
                                icon="ui-icon-plusthick" title="Add Account" update=":accountForm" 
                                actionListener="#{accountController.beforeCreate()}" 
                                style="height: 30px;"/>
                        </div>
                    </f:facet>
                    <p:column headerText="Id" width="1" filterBy="#{account.id}" sortBy="#{account.id}">
                        <h:outputText value="#{account.id}" />
                    </p:column>

                    <p:column headerText="User Name" width="34" filterBy="#{account.user.name}"
                              sortBy="#{account.user.name}">
                        <h:outputText value="#{account.user.name}" />
                    </p:column>

                    <p:column headerText="Account Number" width="30" >
                        <h:outputText value="#{account.accNo}" />
                    </p:column>

                    <p:column headerText="Interest Rate" width="12">
                        <h:outputText value="#{account.interestRate}" />
                    </p:column>

                    <p:column headerText="Opened Date" width="30" filterBy="#{account.openedDate}"
                              sortBy="#{account.openedDate}">
                        <h:outputText value="#{account.openedDate}" />
                    </p:column>

                    <p:column headerText="Mature Date" width="30" filterBy="#{account.matureDate}"
                              sortBy="#{account.matureDate}">
                        <h:outputText value="#{account.matureDate}" />
                    </p:column>

                    <p:column headerText="Balance" width="30">
                        <h:outputText value="#{account.balance}" />
                    </p:column> 

                    <p:column headerText="Product Type" width="35">
                        <h:outputText value="#{account.product.product_type}" />
                    </p:column> 

                    <p:column headerText="Action" width="15">

                        <p:commandButton styleClass="ui-button-raised ui-button-success" 
                                         icon="ui-icon-pencil" oncomplete="PF('accountDialog').show()"
                                         title="Edit Account" update=":accountForm" 
                                         action="#{accountController.beforeUpdate(account)}" />

                        <p:commandButton styleClass="ui-button-raised ui-button-success" 
                                         title="Delete Account"
                                         icon="ui-icon-trash"
                                         actionListener="#{accountController.delete(account)}"
                                         update=":listForm"
                                         />
                    </p:column>
                </p:dataTable>
            </h:form>
        </center> 
    </body>
</html>
